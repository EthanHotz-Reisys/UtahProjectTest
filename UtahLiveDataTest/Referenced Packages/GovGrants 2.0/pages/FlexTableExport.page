<apex:page cache="true" standardStyleSheets="false" controller="GNT.DynamicLayoutExportCtrl" contenttype="{!$CurrentPage.parameters.mode}{!IF($CurrentPage.parameters.mode=='text/csv',SUBSTITUTE('#'+'GG__'+$CurrentPage.parameters.flexTableHeader+'__'+$CurrentPage.parameters.locale+'.csv',' ','_'),SUBSTITUTE('#'+'GG__'+$CurrentPage.parameters.flexTableHeader+'__'+$CurrentPage.parameters.locale+'.xls',' ','_'))}" renderAs="{!IF($CurrentPage.parameters.mode=='pdf','pdf','')}" readonly="true" showHeader="false" sidebar="false" standardStylesheets="false">
	<apex:outputPanel rendered="{!$CurrentPage.parameters.mode == 'pdf'}">
	<apex:stylesheet value="{!themeDocURL}" />
	<div class="topLeftHeader">
		<apex:image url="{!topLeftImageURL}" rendered="{!topLeftImageURL != null}"> </apex:image>
		<apex:outputText value="{!topLeftString}" rendered="{!topLeftString != null}"/>
	</div>
	<div class="topMiddleHeader">
		<apex:image url="{!topMiddleImageURL}" rendered="{!topMiddleImageURL != null}"> </apex:image>
		<apex:outputText value="{!topMiddleString}" rendered="{!topMiddleString != null}"/>
	</div>
	<div class="topRightHeader">
		<apex:image url="{!topRightImageURL}" rendered="{!topRightImageURL != null}"> </apex:image>
		<apex:outputText value="{!topRightString}" rendered="{!topRightString != null}"/>
		<apex:outputText value="Date : {!currentDateTime}" rendered="{!showTimeStamp}"/>
	</div>
	<div class="bottomLeftHeader">
		<apex:image url="{!bottomLeftImageURL}" rendered="{!bottomLeftImageURL != null}"> </apex:image>
		<apex:outputText value="{!bottomLeftString}" rendered="{!bottomLeftString != null}"/>
	</div>
	<div class="bottomRightHeader">
		<apex:image url="{!bottomRightImageURL}" rendered="{!bottomRightImageURL != null}"> </apex:image>
		<apex:outputText value="{!bottomRightString}" rendered="{!bottomRightString != null}"/>
	</div>
	<div class="content">
		<apex:outputPanel rendered="{!$CurrentPage.parameters.flexTableName != ''}" layout="none">
	    <c:FlexTableExport FlextableName="{!$CurrentPage.parameters.flexTableName}" ExportMode="{!$CurrentPage.parameters.mode}"  />
	</apex:outputPanel>
	</div>
	</apex:outputPanel>
	<apex:outputPanel rendered="{!$CurrentPage.parameters.mode != 'pdf' && $CurrentPage.parameters.flexTableName != ''}" layout="none">
		<c:FlexTableExport FlextableName="{!$CurrentPage.parameters.flexTableName}" ExportMode="{!$CurrentPage.parameters.mode}" />
	</apex:outputPanel>
	<apex:outputPanel layout="none" rendered="{!$CurrentPage.parameters.mode == 'pdf' && $CurrentPage.parameters.flexGridName != '' && $CurrentPage.parameters.gridType == 'Mass Editable Grid'}">
		<c:MassEditableGridExport gridName="{!$CurrentPage.parameters.flexGridName}" ExportMode="{!$CurrentPage.parameters.mode}"/>
	</apex:outputPanel>
	<!-- CSV FOR ME GRID -->
	<apex:outputPanel layout="none" rendered="{!$CurrentPage.parameters.mode == 'application/vnd.ms-excel' && $CurrentPage.parameters.flexGridName != '' && $CurrentPage.parameters.gridType == 'Mass Editable Grid'}">
		<c:MassEditableGridExport gridName="{!$CurrentPage.parameters.flexGridName}" ExportMode="{!$CurrentPage.parameters.mode}"/>
	</apex:outputPanel>
	
	<apex:outputPanel layout="none" rendered="{!$CurrentPage.parameters.mode == 'pdf' && $CurrentPage.parameters.flexGridName != '' &&  $CurrentPage.parameters.gridType == 'Nested Navigation Grid'}">
		<c:N2GGridExport gridName="{!$CurrentPage.parameters.flexGridName}" ExportMode="{!$CurrentPage.parameters.mode}"/>
	</apex:outputPanel>
	<!-- CSV FOR ME GRID -->
   <apex:outputPanel layout="none" rendered="{!$CurrentPage.parameters.mode == 'application/vnd.ms-excel' && $CurrentPage.parameters.flexGridName != '' &&  $CurrentPage.parameters.gridType == 'Nested Navigation Grid'}">
		<c:N2GGridExport gridName="{!$CurrentPage.parameters.flexGridName}" ExportMode="{!$CurrentPage.parameters.mode}"/>
	</apex:outputPanel>
</apex:page>